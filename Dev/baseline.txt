# Windows 11 24H2 Security Baseline (Microsoft release 2024-10-01)
# Format: Hive\Path|ValueName|Type|Data
# Each setting is annotated with its ADMX/Group Policy name and LGPO path.

# Account lockout threshold
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Account lockout threshold
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon|LockoutThreshold|REG_DWORD|5

# Account lockout duration
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Account lockout duration
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon|LockoutDuration|REG_DWORD|15

# Reset account lockout counter after
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Reset account lockout counter after
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon|LockoutObservationWindow|REG_DWORD|15

# Minimum password length
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\Minimum password length
HKLM\SYSTEM\CurrentControlSet\Control\Lsa\PasswordComplexity|MinPasswordLength|REG_DWORD|14

# Password must meet complexity requirements
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\Password must meet complexity requirements
HKLM\SYSTEM\CurrentControlSet\Control\Lsa|PasswordComplexity|REG_DWORD|1

# Maximum password age
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\Maximum password age
HKLM\SYSTEM\CurrentControlSet\Control\Lsa|MaximumPasswordAge|REG_DWORD|60

# Store passwords using reversible encryption
# LGPO: Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\Store passwords using reversible encryption
HKLM\SYSTEM\CurrentControlSet\Control\Lsa|DisableReversiblePasswordEncryption|REG_DWORD|1

# Do not display last signed-in user name
# LGPO: Computer Configuration\Administrative Templates\System\Logon\Do not display last signed-in
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|DontDisplayLastUserName|REG_DWORD|1

# Require smart card for interactive logon
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Interactive logon: Require smart card
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|ScForceOption|REG_DWORD|0

# Use Windows Hello for Business
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Hello for Business\Use Windows Hello for Business
HKLM\SOFTWARE\Policies\Microsoft\PassportForWork|Enabled|REG_DWORD|1

# Disable SMBv1 client driver
# LGPO: Computer Configuration\Administrative Templates\Network\Lanman Workstation\Enable insecure guest logons
HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb10|Start|REG_DWORD|4

# Require SMB signing (server)
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Microsoft network server: Digitally sign communications (always)
HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters|RequireSecuritySignature|REG_DWORD|1

# Require SMB signing (client)
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Microsoft network client: Digitally sign communications (always)
HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters|RequireSecuritySignature|REG_DWORD|1

# Restrict anonymous access to Named Pipes and Shares
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Network access: Restrict anonymous access to Named Pipes and Shares
HKLM\SYSTEM\CurrentControlSet\Control\Lsa|RestrictAnonymous|REG_DWORD|1

# Audit account logon events
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Audit Policy\Audit account logon events
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|AuditAccountLogon|REG_DWORD|3

# Audit logon events
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Audit Policy\Audit logon events
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|AuditLogonEvents|REG_DWORD|3

# Audit object access
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Audit Policy\Audit object access
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|AuditObjectAccess|REG_DWORD|3

# Enable Windows Defender Antivirus
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Microsoft Defender Antivirus\Turn off Microsoft Defender Antivirus
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender|DisableAntiSpyware|REG_DWORD|0

# Enable behavior monitoring
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Microsoft Defender Antivirus\Behavior monitoring
HKLM\SOFTWARE\Policies\Microsoft\Microsoft Antimalware\Signature Updates|DisableBehaviorMonitoring|REG_DWORD|0

# Enable cloud protection
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Microsoft Defender Antivirus\Allow cloud protection
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Cloud|DoEnableCloudProtection|REG_DWORD|1

# Enable automatic sample submission
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Microsoft Defender Antivirus\Configure automatic sample submission
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet|SubmitSamplesConsent|REG_DWORD|1

# Enable Tamper Protection
# LGPO: Computer Configuration\Windows Components\Microsoft Defender Antivirus\Tamper Protection
HKLM\SOFTWARE\Microsoft\Windows Defender\Features|TamperProtection|REG_DWORD|5

# Configure Automatic Updates
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Update\Configure Automatic Updates
HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU|AUOptions|REG_DWORD|4

# Automatic Updates detection frequency
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Update\Automatic Updates detection frequency
HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU|DetectionFrequency|REG_DWORD|22

# Disable Autorun for all drives
# LGPO: Computer Configuration\Administrative Templates\Windows Components\AutoPlay Policies\Turn off Autoplay
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer|NoDriveTypeAutoRun|REG_DWORD|255

# Run all administrators in Admin Approval Mode
# LGPO: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\User Account Control: Run all administrators in Admin Approval Mode
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System|ConsentPromptBehaviorAdmin|REG_DWORD|5

# Disable Remote Desktop
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections\Allow users to connect remotely using Remote Desktop Services
HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server|fDenyTSConnections|REG_DWORD|1

# Enable Windows Firewall (Domain profile)
# LGPO: Computer Configuration\Windows Settings\Security Settings\Windows Defender Firewall\Domain Profile\Windows Defender Firewall: Protect all network connections
HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile|EnableFirewall|REG_DWORD|1

# Enable Windows Firewall (Private profile)
# LGPO: Computer Configuration\Windows Settings\Security Settings\Windows Defender Firewall\Private Profile\Windows Defender Firewall: Protect all network connections
HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile|EnableFirewall|REG_DWORD|1

# Disable inbound remote administration
# LGPO: Computer Configuration\Windows Settings\Security Settings\Windows Defender Firewall\Windows Defender Firewall: Allow inbound remote administration exception
HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules|MpsSvcRule_All|REG_SZ|Disabled

# Require additional authentication at startup (BitLocker)
# LGPO: Computer Configuration\Administrative Templates\Windows Components\BitLocker Drive Encryption\Require additional authentication at startup
HKLM\SOFTWARE\Policies\Microsoft\FVE|RDVIgnore|REG_DWORD|0

# Require device encryption
# LGPO: Computer Configuration\Administrative Templates\Windows Components\BitLocker Drive Encryption\Choose drive encryption method and cipher strength
HKLM\SYSTEM\CurrentControlSet\Control\BitLocker\Settings|EncryptionMethod|REG_DWORD|2147483648

# Do not allow storage of passwords and credentials for network authentication
# LGPO: Computer Configuration\Administrative Templates\System\Credentials Delegation\Do not allow storage of passwords and credentials for network authentication
HKLM\SOFTWARE\Policies\Microsoft\CredUI|DisablePasswordCaching|REG_DWORD|1

# Block executable content from email and webmail
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Microsoft Defender Exploit Guard\Attack surface reduction rules
HKLM\SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules|BlockEmailClientRule|REG_DWORD|1

# Prevent extension installation from external stores (Edge)
# LGPO: Computer Configuration\Administrative Templates\Microsoft Edge\Control where extensions are installed from
HKLM\SOFTWARE\Policies\Microsoft\Edge|ExtensionInstallBlocklist|REG_SZ|*

# Disable Windows Script Host
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Script Host\Prevent access to the Windows Script Host
HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings|Enabled|REG_DWORD|0

# Enable Virtualization Based Security
# LGPO: Computer Configuration\Administrative Templates\System\Device Guard\Turn on Virtualization Based Security
HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard|EnableVirtualizationBasedSecurity|REG_DWORD|1
HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity|Enabled|REG_DWORD|1

# Restrict WinRM remote access
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Remote Management (WinRM)\WinRM Service\Allow remote server management through WinRM
HKLM\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service|AllowAutoShareAccess|REG_DWORD|0

# Enable Windows Defender Application Control
# LGPO: Computer Configuration\Administrative Templates\Windows Components\Windows Defender Application Control\Deploy Windows Defender Application Control
HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard|EnableWDAC|REG_DWORD|1